services:
  _defaults:
    autowire: true
    autoconfigure: true
    public: false

  # Auto-register all classes in Classes/ directory
  Hn\MailSender\:
    resource: '../Classes/*'
    exclude: '../Classes/Domain/Model/*'

  # Autoconfigure validators with tag
  _instanceof:
    Hn\MailSender\Validation\SenderAddressValidatorInterface:
      tags: ['mail_sender.validator']
    Hn\MailSender\Import\SenderAddressSourceProviderInterface:
      tags: ['mail_sender.source_provider']

  # Validation Service with tagged iterator
  Hn\MailSender\Service\ValidationService:
    public: true
    arguments:
      $validators: !tagged_iterator mail_sender.validator
      $emlParserService: '@Hn\MailSender\Service\EmlParserService'

  # Sender Address Import Service (public for scheduler task access)
  Hn\MailSender\Service\SenderAddressImportService:
    public: true
    arguments:
      $sourceProviders: !tagged_iterator mail_sender.source_provider

  # Backend Module Controller
  Hn\MailSender\Controller\MailSenderController:
    public: true

  # Console Command
  Hn\MailSender\Command\ValidateSenderCommand:
    tags:
      - name: 'console.command'
        command: 'mail:sender:validate'
        description: 'Validate email sender addresses'

  # Status Report Provider
  Hn\MailSender\Report\MailSenderStatusProvider:
    tags:
      - name: 'reports.status'
